<div class="container">
    <div class="row">
    <%= form_tag(register_students_path, method: "post") do %>

        <div class="span3">
            <div class="bottom-gap">
                <%= label_tag :course_types %>
                <select id="course_types" name="student[course][course_types]">
                    <option value=""></option>
                    <%= StudentCourse.all.each do |sc| %>
                        <option value="<%=sc.id%>"><%=sc.type_name%></option>
                    <% end %>
                </select>
            </div>

            <div class="bottom-gap">
                <%= label_tag :additional_modules %>
                <select id="additional_modules" name="student[course][additional_modules]">
                    <option value=""></option>
                    <%= AdditionalModule.all.each do |sc| %>
                        <option value="<%=sc.id%>"><%=sc.type_name%></option>
                    <% end %>
                </select>
            </div>

            <div class="bottom-gap">
                <%= label_tag :date_enrolled %>
                <input type="text" id="date_enrolled" name="student[course][enrolled_at]" class="datepicker">
            </div>

            <div class="bottom-gap">
                <%= label_tag :first_name %>
                <input type="text" id="first_name" name="student[bio][first_name]">
            </div>

            <div class="bottom-gap">
                <%= label_tag :middle_name %>
                <input type="text" id="middle_name" name="student[bio][middle_name]">
            </div>

            <div class="bottom-gap">
                <%= label_tag :last_name %>
                <input type="text" id="last_name" name="student[bio][last_name]">
            </div>

            <div class="bottom-gap">
                <%= label_tag :phone %>
                <input type="text" id="phone" name="student[bio][phone]">
            </div>

            <div class="bottom-gap">
                <%= label_tag :mobile %>
                <input type="text" id="mobile" name="student[bio][mobile]">
            </div>

            <div class="bottom-gap">
                <%= label_tag :email %>
                <input type="text" id="email" name="student[bio][email]">
            </div>

            <div class="bottom-gap">
                <%= label_tag :fax %>
                <input type="text" id="fax" name="student[bio][fax]">
            </div>

            <div class="bottom-gap-50"></div>

        </div>

        <div class="span3">
            <div class="border-bottom">
                <%= label_tag :postal_details, nil %>
            </div>

            <div class="top-gap bottom-gap">
                <%= label_tag :address %>
                <input type="text" id="address" name="student[address][address]" >
            </div>

            <div class="bottom-gap">
                <%= label_tag :postal_code,nil, :class => 'control-label' %>
                    <input type="text" id="student_postal_code" autocomplete="off" placeholder="Enter Postal Code" >
                    <input type="hidden" id="student_postal_code_hidden" name="student[address][postal_code]" />
                    <input type="hidden" id="course_hidden" name="student[course][course_id]" value="" />

            </div>

            <div class="bottom-gap">
                <%= label_tag :town,nil, :class => 'control-label' %>
                    <select id="student_town" name="student[address][town_id]">
                        <option value=""></option>
                    </select>
            </div>

            <div class="bottom-gap">
                <%= label_tag :state, nil, :class => 'control-label' %>
                <select id="student_state" name="student[address][state_id]">
                    <option value=""></option>
                </select>
            </div>

            <div class="border-bottom">
                <%= label_tag :further_information, nil %>
            </div>

            <div class="top-gap bottom-gap">
                <%= label_tag :industry, nil, :class => 'control-label' %>
                <select id="course" name="student[course][industry]">
                    <option value=""></option>
                    <option value="val1">val1</option>
                    <option value="val2">val2</option>
                </select>
            </div>

            <div class="bottom-gap row" style="margin-left:0px">
                <div class="bottom-gap pull-left">
                    <input id="hearing" name="student[needs][hearing]" type="checkbox" class="pull-left" value="1"/>
                    <label class="pull-left left-gap-10" for="hearing">Hearing/Deaf</label>
                </div>

                <div class="bottom-gap pull-right" style="margin-right:50px">
                    <input id="learning" name="student[needs][learning]" type="checkbox" class="pull-left" value="1"/>
                    <label class="pull-left left-gap-10" for="learning">Learning</label>
                </div>
            </div>



            <div class="bottom-gap row" style="margin-left:0px">
                <div class="bottom-gap pull-left">
                    <input id="vision" name="student[needs][vision]" type="checkbox" class="pull-left" value="1"/>
                    <label class="control-label pull-left left-gap-10" for="vision">Vision</label>
                </div>

                <div class="bottom-gap pull-right" style="margin-right:50px">
                    <input id="physical" name="student[needs][physical]" type="checkbox" class="pull-left" value="1"/>
                    <label class="control-label pull-left left-gap-10" for="physical">Physical</label>
                </div>
            </div>

            <div class="bottom-gap row" style="margin-left:0px">
                <div class="bottom-gap pull-left">
                    <input id="mental" name="student[needs][mental]" type="checkbox" class="pull-left" value="1"/>
                    <label class="control-label pull-left left-gap-10" for="mental">Mental</label>
                </div>

                <div class="bottom-gap pull-right" style="margin-right:50px">
                    <input id="medical" name="student[needs][medical]" type="checkbox" class="pull-left" value="1"/>
                    <label class="control-label pull-left left-gap-10" for="medical">Medical Condition</label>
                </div>
            </div>

            <div class="bottom-gap row" style="margin-left:0px">
                <div class="bottom-gap pull-left">
                    <input id="intellectual" name="student[needs][intellectual]" type="checkbox" class="pull-left" value="1"/>
                    <label class="control-label pull-left left-gap-10" for="intellectual">Intellectual</label>
                </div>

                <div class="bottom-gap pull-right" style="margin-right:50px">
                    <input id="brain" name="student[needs][brain]" type="checkbox" class="pull-left" value="1"/>
                    <label class="control-label pull-left left-gap-10" for="brain">Acquired Brain Impairment</label>
                </div>
            </div>

            <div class="bottom-gap">
                <%= label_tag :others_specify %>
                <input type="text" id="others" name="student[course][needs_specify]" >
            </div>

            <div class="bottom-gap-50"></div>
        </div>

        <div class="span3">
            <div class="bottom-gap">
                <%= label_tag :comments %>
                <textarea rows="3" id="comments" name="student[course][comments]"></textarea>
            </div>



            <div class="bottom-gap">
                <%= label_tag :course_fee %>
                <input type="text" id="course_fee" name="student[course][course_fee]" >
            </div>

            <div class="bottom-gap">
                <%= label_tag :payment_method,nil, :class => 'control-label' %>
                <select id="payment_method" name="student[course][payment_method]">
                    <option value=""></option>
                    <option value="card">card</option>
                    <option value="cash">cash</option>
                </select>
            </div>

            <div class="bottom-gap">
                <%= label_tag :payment_date %>
                <input type="text" id="payment_date" name="student[course][payment_date]" class="datepicker">
            </div>

            <div class="bottom-gap row" style="margin-left:0px">
                <input id="paid" name="student[course][paid]" type="checkbox" class="pull-left" value="1"/>
                <label class="pull-left left-gap-10" for="paid">Paid</label>
            </div>

        </div>

        <div class="span3">
            <div class="bottom-gap">
                <%= label_tag :current_accreditation %>
                <input type="text" id="current_accreditation" name="student[course][current_accreditation]" >
            </div>

            <div class="bottom-gap">
                <%= label_tag :current_expiry_date %>
                <input type="text" id="current_expiry_date" name="student[course][current_expiry_date]" class="datepicker" >
            </div>

            <div class="top-gap bottom-gap">
                <label for="feedback" id="feedback">How did you hear about Chemcert?</label>
                <select id="feedback" name="student[demo][feedback]">
                    <option value=""></option>
                    <option value="paper">paper</option>
                    <option value="news">news</option>
                    <option value="email">email</option>
                    <option value="friend">friend</option>
                </select>
            </div>

            <div class="bottom-gap">
                <%= label_tag :other %>
                <input type="text" id="feedback2" name="student[demo][feedback2]">
            </div>

            <div class="form-actions">
                <div class="row bottom-gap-20">
                    <%= submit_tag "Enquiry", :id => 'save_enquiry', :class => 'btn btn-primary pull-left' %>
                </div>

                <div class="row">
                    <%= submit_tag "Enrollment", :id => 'save_enrolment', :class => 'btn btn-primary pull-left'%>
                </div>
            </div>
    </div>

    <% end %>
    </div>
</div>

<script type="text/javascript">


       $('#student_postal_code').typeahead(
            {
                minLength: 2,
                source : function(query, process) {
                    map = {};
                    postal_codes = [];
                    $.ajax({
                        url : '/postal_codes/code.json',
                        type : 'get',
                        data : 'code='+query,
                        dataType: 'JSON',
                        success : function(data) {
                            $.each(data, function(index, element) {
                                postal_codes.push(element.code);
                                map[element.code] = element;
                            });
                            process(postal_codes);
                        }
                    });
                },
                updater : function(item) {
                    $('#student_postal_code_hidden').val(map[item].id);
                    $('#student_postal_code').val(map[item].name);
                    return item;
                }

            }
    );

    $('#student_postal_code').change(function(){
        //adding course here as well.
        console.log($('#course_dates').val());
        postal_code = $(this).val();
        console.log(postal_code);
        $.ajax({
            url : '/location_relations/postal_code.json',
            type : 'get',
            data : 'postal_code='+postal_code,
            dataType: 'JSON',
            success : function(data) {
                $('#student_town').empty();
                $('#student_state').empty();
                $('#student_town').append("<option value="+data[0].town_id+" selected=selected>"+data[0].town+"</option>");
                $('#student_state').append("<option value="+data[0].state_id+" selected=selected>"+data[0].state+"</option>");
                data.shift();
                $.each(data, function(index, element) {
                    $('#student_town').append("<option value="+element.town_id+">"+element.town+"</option>");
                    $('#student_state').append("<option value="+element.state_id+">"+element.state+"</option>");
                });

            }
        });
    });

</script>




<style>
    select {
        height: 25px;
    }

    input[type="text"] {
        height: 20px;
    }

    .table-striped tbody > tr:nth-child(2n+1) > th {
        background-color:#606060;
        color:#FFF;
    }

    .table td{
        background-color:#E0E0E0;
        color:#fff;
    }

    .table-striped tbody > tr:nth-child(2n+1) > td {
        background-color:#D0D0D0;
        color:#000;
    }
</style>